/**
 * GRID-BASED SEMANTIC LAYOUT
 * Uses grid-template-areas for clean, accessible structure
 *
 * PREFER TAILWIND UTILITY CLASSES WHENEVER POSSIBLE
 *
 * Breakpoints:
 * sm = 640px  | md = 768px | lg = 1024px | xl = 1280px | 2xl = 1536px
**/

@import "tailwindcss";

@layer utilities {
    /* ... */
}

#page-layout {
    @apply grid min-h-screen w-full bg-gray-100;

    /* Simple 3-row layout: nav, main-area, footer */
    grid-template-areas:
        "nav"
        "main-area"
        "foot";
    grid-template-rows: auto 1fr auto;
    grid-template-columns: 1fr;

    /* md (768px): sidebars side-by-side under main */
    @media (min-width: 768px) {
        @apply bg-gray-700;
    }

    /* Grid area assignments */
    > nav {
        grid-area: nav;
        @apply bg-gray-200;
        @apply sticky top-0 z-10;
    }

    > #main-area {
        grid-area: main-area;
        @apply grid gap-0;

        > * {
            @apply py-4 md:p-4;
        }

        /* sm(640px): vertical stack */
        grid-template-areas:
            "main"
            "sl"
            "sr";
        grid-template-columns: 1fr;
        grid-template-rows: 1fr auto auto;

        /* md(768px): sidebars side-by-side below */
        @media (min-width: 768px) {
            grid-template-areas:
                "main   main"
                "sl     sr";
            grid-template-columns: 1fr 1fr;
            grid-template-rows: auto 1fr;
        }

        /*&:has(.sidebar *) {*/
        /* lg(1024px): sidebars beside main */
        @media (min-width: 1024px) {
            grid-template-areas:
                "sl     main"
                "sr     main";
            grid-template-columns: 350px 1fr;
            grid-template-rows: auto 1fr;
        }

        /* 2xl(1536px): 3 columns */
        @media (min-width: 1536px) {
            grid-template-areas: "sl     main   sr";
            grid-template-columns: 350px 1fr 350px;

            /* Only left sidebar */
            &:has(#sidebar-left *):not(:has(#sidebar-right *)) {
                grid-template-areas: "sl     main";
                grid-template-columns: 480px 1fr;
            }

            /* Only right sidebar */
            &:has(#sidebar-right *):not(:has(#sidebar-left *)) {
                grid-template-areas: "main   sr";
                grid-template-columns: 1fr 480px;
            }
        }

        > main {
            @apply h-full;
            @media (min-width: 1536px) {
                @apply max-w-none;
            }
        }
        /*}*/

        > main {
            @apply bg-gray-100 space-y-8;

            > header {
                &:not(:has(*)) {
                    @apply hidden;
                }
            }
        }

        .sidebar {
            @apply p-4 sticky inset-y-16;

            /*&:not(:has(*)) {
                @apply hidden;
            }*/

            @media (min-width: 1024px) {
                @apply h-fit;
            }

            &#sidebar-left {
                grid-area: sl;
            }

            &#sidebar-right {
                grid-area: sr;
            }
        }
    }

    > footer {
        grid-area: foot;
        @apply sticky bottom-0 z-10;

        /* Hide footer if empty */
        &:not(:has(*)) {
            @apply hidden;
        }
    }
}

/* Container query support for sidebars */
#sidebar-left,
#sidebar-right {
    container-type: inline-size;
}

/* Reset margins for first/last children */
#main-area > header,
#main-area > main,
.sidebar,
.card {
    > :first-child {
        @apply mt-0;
    }

    > :last-child {
        @apply mb-0;
    }
}
