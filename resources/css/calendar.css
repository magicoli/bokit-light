@import "tailwindcss";
@import "./_theme.css";

/* Calendar special case: hide sidebars on large screens */
#page-layout:has(.calendar-wrapper) {
    @media (min-width: 1024px) {
        .sidebar,
        #sidebar-left,
        #sidebar-right {
            @apply hidden;
        }

        #main-area {
            @apply h-full;
            /* Full width layout for calendar */
            grid-template-areas: "main";
            grid-template-columns: 1fr;
            grid-template-rows: 1fr;
        }
    }
}

/* =============================================================================
   CALENDAR NAVIGATION
   ============================================================================= */

/*main {
    > * {
        @apply max-w-none;
    }
}*/

header {
    @apply hidden;
    background: lightgreen;
}

.text-mobile-only {
    @media (min-width: 640px) {
        @apply hidden;
    }
}

.text-desktop-only {
    @apply hidden;

    @media (min-width: 640px) {
        @apply inline;
    }
}

.calendar-nav {
    @apply bg-white rounded-lg shadow-sm border border-light p-2 mb-6;

    @media (min-width: 640px) {
        @apply p-4;
    }

    .nav-controls {
        @apply flex items-center justify-between gap-2;
    }

    .nav-left {
        @apply flex items-center gap-1;
    }

    .nav-button {
        @apply inline-flex items-center justify-center border border-light rounded-md text-sm font-medium bg-white hover:bg-gray-50 transition-colors;
        width: 2.5rem;
        height: 2.5rem;

        &:active {
            @apply bg-light;
        }

        &.today {
            @apply border-2 border-primary text-primary hover:bg-blue-50;
            width: auto;
            padding: 0.5rem 0.5rem;

            @media (min-width: 640px) {
                padding: 0.5rem 0.75rem;
            }

            &:active {
                @apply bg-blue-100;
            }
        }

        &:disabled,
        &.disabled {
            @apply text-muted cursor-not-allowed;
        }
    }

    .period {
        @apply flex flex-wrap justify-center items-baseline gap-x-2 mx-auto;

        h2 {
            @apply text-lg font-bold  truncate m-0 p-0;

            @media (min-width: 640px) {
                @apply text-2xl;
            }
        }

        .timezone,
        .week-info {
            @apply text-xs text-secondary m-0 p-0 truncate;
        }
    }

    .nav-right {
        @apply flex items-center gap-1;
    }
}

/* =============================================================================
   CALENDAR TABLE
   ============================================================================= */

.calendar-wrapper {
    @apply bg-white rounded-lg shadow-sm border border-light overflow-x-hidden;
}

.calendar-table-container {
    @apply inline-block min-w-full align-middle;
}

.calendar-table {
    @apply min-w-full divide-y divide-light;
    table-layout: fixed;
}

/* =============================================================================
   TABLE HEADER
   ============================================================================= */

.calendar-header {
    @apply bg-gray-50 sticky top-0 z-10;

    .unit-column {
        @apply sticky left-0 z-20 bg-gray-50 px-4 py-3 text-left text-xs font-medium uppercase tracking-wider border-r-2 border-light min-w-[100px] w-[120px];

        @media (max-width: 639px) {
            @apply hidden;
        }
    }

    .day-column {
        @apply px-1 py-2 text-center min-w-[38px] border-r border-light relative;

        &.today {
            @apply bg-blue-50/50;
        }

        .day-name {
            @apply text-xs font-medium;
        }

        .day-number {
            @apply text-sm font-bold;

            &.today {
                @apply text-primary;
            }
        }
    }
}

/* =============================================================================
   TABLE BODY
   ============================================================================= */

.calendar-body {
    @apply bg-white divide-y divide-light;
}

.property-row {
    @apply border-t-2 border-light;

    &:not(.unit-row) {
        @apply bg-light;
    }

    .property-name {
        @apply sticky left-0 z-10 bg-light px-4 py-2 border-r-2 border-light font-bold text-sm;

        @media (max-width: 639px) {
            @apply hidden;
        }

        .timezone {
            @apply text-xs font-normal;
        }
    }

    .property-spacer {
        @apply bg-light border-r border-light;

        &.weekend {
            @apply bg-light/50;
        }
    }
}

.unit-row {
    @apply hover:bg-gray-50 transition-colors;

    .unit-cell {
        @apply sticky left-0 z-10 bg-white px-4 py-3 border-r-2 border-light hover:bg-gray-50;

        @media (max-width: 639px) {
            @apply hidden;
        }
    }

    .unit-info {
        @apply flex items-center space-x-2;

        .unit-name {
            @apply font-medium  text-sm;
        }

        .timezone {
            @apply text-secondary text-xs font-normal;
        }
    }
}

/* =============================================================================
   DAY CELLS
   ============================================================================= */

.day-cell {
    @apply relative h-16 px-0 border-r border-light;

    @media (max-width: 639px) {
        @apply h-20;
    }

    /* 3 niveaux de gris : passé (50) < weekend (100) */
    &.past {
        @apply bg-light;
    }

    &.weekend {
        @apply bg-light/75;
    }

    .unit-label-mobile {
        @apply absolute left-2 top-1 text-xs font-semibold z-20 px-1.5 py-0.5 rounded shadow-sm bg-black/75 text-white;

        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;

        @media (min-width: 640px) {
            @apply hidden;
        }

        .timezone {
            @apply text-secondary text-xs font-normal;
        }
    }

    .today-highlight {
        @apply absolute inset-0 bg-blue-200/50 pointer-events-none;
    }
}

/* =============================================================================
   BOOKING BLOCKS
   ============================================================================= */

.booking-block {
    @apply absolute rounded-full text-white bg-unknown text-xs font-medium overflow-hidden hover:shadow-xl hover:opacity-100 transition-all flex items-center px-4 cursor-pointer z-10;
    @apply top-1 bottom-1 m-0 gap-4;

    &.continued {
        @apply rounded-l-none;
        &:before {
            @apply text-xs opacity-75;
            @apply absolute left-1;
            content: "◀";
        }
    }
    &.continues {
        @apply rounded-r-none;
        .guest-name:after {
            @apply opacity-75;
            /*@apply absolute right-1;*/
            content: "▶";
        }
    }

    .icon-ota svg {
        @apply w-6 h-6;
    }

    .guest-name {
        @apply truncate text-lg flex-2;
    }

    .extends {
        @apply opacity-75 ms-auto;
    }

    .status-badge {
        @apply font-bold text-xs bg-black/50 px-1 rounded;
    }
}

.booking-block,
.modal-header {
    &.status-confirmed {
        @apply bg-confirmed;
    }

    &.status-new {
        @apply bg-new;
    }

    &.status-cancelled {
        @apply bg-cancelled;
    }

    &.status-request {
        @apply bg-request;
    }

    &.status-inquiry {
        @apply bg-inquiry;
    }

    &.status-unavailable {
        @apply bg-unavailable;
    }

    &.status-blocked {
        @apply bg-blocked;
    }

    &.status-vanished {
        @apply bg-vanished;
    }

    &.status-unknown {
        @apply bg-unknown;
    }
}

/* =============================================================================
   BOOKING MODAL
   ============================================================================= */

.modal-backdrop {
    @apply fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50;
}

.modal {
    @apply container max-w-lg p-0;

    > div {
        @apply p-0;
    }

    .close-button {
        @apply text-secondary hover:text-highlight;

        svg {
            @apply w-6 h-6;
        }
    }

    .modal-header,
    .modal-footer {
        @apply text-dark bg-light flex justify-between items-start;

        &:has(:not(*)) {
            @apply hidden;
        }
    }

    .modal-header {
        h3 {
            @apply text-xl font-bold;
        }
    }

    .modal-content {
        @apply space-y-3 max-h-[calc(100vh-6rem)] overflow-y-auto;
    }

    .unit-info {
        @apply w-full flex justify-start items-center gap-2;

        .unit-name {
            @apply grow font-medium;
        }

        .actions {
            @apply inline-flex ms-auto gap-2 text-nowrap;

            .action-link {
                @apply m-0 p-0 align-baseline;

                svg {
                    @apply w-5 h-5 align-baseline rounded;
                }

                a svg {
                    @apply hover:bg-dark hover:text-light;
                }
            }
        }

        .status-confirmed,
        .status-new {
            svg {
                @apply bg-green-500 text-white m-0;
            }
        }
    }

    .fields-row {
        @apply flex items-center justify-between;

        .status-badge {
            @apply inline-flex items-center px-2 py-1 rounded text-white text-xs font-semibold;
        }
    }

    .dates-section {
        @apply border-y py-3 grid grid-cols-3 gap-4;

        .date-field {
            label {
                @apply text-xs font-medium text-secondary uppercase block;
            }

            .value {
                @apply text-sm  font-semibold mt-1;
            }
        }
    }

    .detail-section {
        .detail-line {
            @apply flex flex-wrap text-sm mb-1;

            .label {
                @apply w-32 font-medium;
            }

            .value {
                @apply ml-2;
            }
        }
    }
    .card-footer {
        > &:has(:not(*)) {
            @apply hidden;
        }
        @apply flex justify-between items-center gap-4;
    }
    .source-section {
        .source-line {
            @apply text-sm mb-1;

            .label {
                @apply font-medium text-secondary;
            }

            .value {
                @apply ml-2;
            }

            .link {
                @apply text-primary hover:underline ml-2;
            }
        }
    }

    .comments-section {
        label {
            @apply text-sm font-medium text-secondary block mb-2;
        }

        .comments-text {
            @apply text-sm bg-gray-50 p-3 rounded whitespace-pre-wrap;
        }
    }
}
