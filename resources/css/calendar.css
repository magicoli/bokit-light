@import "tailwindcss";

/* =============================================================================
   CALENDAR NAVIGATION
   ============================================================================= */

.text-mobile-only {
    @media (min-width: 640px) {
        @apply hidden;
    }
}

.text-desktop-only {
    @apply hidden;

    @media (min-width: 640px) {
        @apply inline;
    }
}

.calendar-nav {
    @apply bg-white rounded-lg shadow-sm border border-gray-200 p-2 mb-6;

    @media (min-width: 640px) {
        @apply p-4;
    }

    .nav-controls {
        @apply flex items-center justify-between gap-2;
    }

    .nav-left {
        @apply flex items-center space-x-1;
    }

    .nav-button {
        @apply inline-flex items-center justify-center border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors;
        width: 2.5rem;
        height: 2.5rem;

        &:active {
            @apply bg-gray-200;
        }

        &.today {
            @apply border-2 border-blue-500 text-blue-600 hover:bg-blue-50;
            width: auto;
            padding: 0.5rem 0.5rem;

            @media (min-width: 640px) {
                padding: 0.5rem 0.75rem;
            }

            &:active {
                @apply bg-blue-100;
            }
        }

        &:disabled,
        &.disabled {
            @apply text-gray-400 bg-gray-100 cursor-not-allowed;
        }
    }

    .period {
        @apply flex flex-col items-center min-w-0 flex-1;

        h2 {
            @apply text-lg font-bold text-gray-900 truncate;

            @media (min-width: 640px) {
                @apply text-2xl;
            }
        }

        .week-info {
            @apply text-xs text-gray-500 mt-1;
        }
    }

    .nav-right {
        @apply flex items-center space-x-1;
    }
}

/* =============================================================================
   CALENDAR TABLE
   ============================================================================= */

.calendar-wrapper {
    @apply bg-white rounded-lg shadow-sm border border-gray-200 overflow-x-hidden;
}

.calendar-table-container {
    @apply inline-block min-w-full align-middle;
}

.calendar-table {
    @apply min-w-full divide-y divide-gray-200;
    table-layout: fixed;
    
    /* À partir de 1280px, les colonnes doivent afficher tout le mois */
    @media (min-width: 1280px) {
        /* Calcul: (1280px - 120px colonne unit) / 31 jours = ~37.4px par jour */
        /* On utilise width pour forcer l'affichage du mois complet */
        width: 100%;
    }
    
    /* Au-delà de 1980px, laisser les colonnes s'adapter librement */
    @media (min-width: 1980px) {
        table-layout: auto;
    }
}
}

/* =============================================================================
   TABLE HEADER
   ============================================================================= */

.calendar-header {
    @apply bg-gray-50 sticky top-0 z-10;

    .unit-column {
        @apply sticky left-0 z-20 bg-gray-50 px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider border-r-2 border-gray-300 min-w-[100px] w-[120px];

        @media (max-width: 639px) {
            @apply hidden;
        }
    }

    .day-column {
        @apply px-1 py-2 text-center border-r border-gray-200 relative;
        min-width: 38px;
        
        /* Pour 1280px: (1280 - 120) / 31 = 37.4px */
        @media (min-width: 1280px) {
            width: calc((100% - 120px) / 31);
            max-width: calc((100% - 120px) / 31);
        }
        
        /* Au-delà de 1980px, largeur flexible */
        @media (min-width: 1980px) {
            width: auto;
            max-width: none;
        }

        &.today {
            @apply bg-blue-50/50;
        }

        &.past {
            @apply bg-gray-100;
        }

        &.weekend {
            @apply bg-gray-50;
        }

        /* Weekend prend le dessus sur past */
        &.weekend.past {
            @apply bg-gray-100;
        }

        .day-name {
            @apply text-xs font-medium text-gray-700;
        }

        .day-number {
            @apply text-sm font-bold text-gray-900;

            &.today {
                @apply text-blue-600;
            }
        }
    }
}

/* =============================================================================
   TABLE BODY
   ============================================================================= */

.calendar-body {
    @apply bg-white divide-y divide-gray-200;
}

.property-row {
    @apply bg-gray-100 border-t-2 border-gray-300;

    .property-name {
        @apply sticky left-0 z-10 bg-gray-100 px-4 py-2 border-r-2 border-gray-300 font-bold text-gray-800 text-sm;

        @media (max-width: 639px) {
            @apply hidden;
        }
    }

    .property-spacer {
        @apply bg-gray-100 border-r border-gray-200;

        &.past {
            @apply bg-gray-100;
        }

        &.weekend {
            @apply bg-gray-50;
        }

        &.weekend.past {
            @apply bg-gray-100;
        }
    }
}

.unit-row {
    @apply hover:bg-gray-50 transition-colors;

    .unit-cell {
        @apply sticky left-0 z-10 bg-white px-4 py-3 border-r-2 border-gray-300 hover:bg-gray-50;

        @media (max-width: 639px) {
            @apply hidden;
        }
    }

    .unit-info {
        @apply flex items-center space-x-2;

        .unit-name {
            @apply font-medium text-gray-900 text-sm whitespace-nowrap;
        }
    }
}

/* =============================================================================
   DAY CELLS
   ============================================================================= */

.day-cell {
    @apply relative h-16 px-0 border-r border-gray-200;

    @media (max-width: 639px) {
        @apply h-20;
    }

    &.past {
        @apply bg-gray-100;
    }

    &.weekend {
        @apply bg-gray-50;
    }

    &.weekend.past {
        @apply bg-gray-100;
    }

    .unit-label-mobile {
        @apply absolute top-0.5 left-0.5 text-[0.6rem] font-semibold z-[5] px-1 py-0.5 rounded;

        @media (min-width: 640px) {
            @apply hidden;
        }
    }

    .today-highlight {
        @apply absolute inset-0 bg-blue-50 opacity-40 pointer-events-none;

        @media (max-width: 639px) {
            top: 1.75rem !important;
        }
    }
}

/* =============================================================================
   BOOKING BLOCKS
   ============================================================================= */

.booking-block {
    @apply absolute rounded-xl text-white text-xs font-medium overflow-hidden hover:shadow-xl hover:opacity-100 transition-all flex items-center px-2 cursor-pointer z-10;

    @media (max-width: 639px) {
        top: 1.75rem !important;
    }

    .continues {
        @apply opacity-75 mr-1;
    }

    .guest-name {
        @apply truncate text-lg flex-2;
    }

    .extends {
        @apply opacity-75 ms-auto;
    }

    .status-badge {
        @apply font-bold text-xs bg-black/50 px-1 rounded;
    }
}

/* =============================================================================
   BOOKING MODAL
   ============================================================================= */

.booking-modal-backdrop {
    @apply fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50;
}

.booking-modal {
    @apply bg-white rounded-lg shadow-xl max-w-md w-full p-6;

    .modal-header {
        @apply flex justify-between items-start mb-4;

        h3 {
            @apply text-xl font-bold text-gray-900;

            .badge-deleted {
                @apply inline-block bg-red-600 text-white text-xs font-bold px-2 py-1 rounded mr-2;
            }
        }

        .close-button {
            @apply text-gray-400 hover:text-gray-600;

            svg {
                @apply w-6 h-6;
            }
        }
    }

    .modal-content {
        @apply space-y-3;
    }

    .field-row {
        @apply flex items-center justify-between;

        .unit-info {
            @apply flex items-center;

            .unit-name {
                @apply text-sm font-medium text-gray-900;
            }
        }

        .status-badge {
            @apply inline-flex items-center px-2 py-1 rounded text-white text-xs font-semibold;
        }
    }

    .dates-section {
        @apply border-t pt-3 grid grid-cols-3 gap-4;

        .date-field {
            label {
                @apply text-xs font-medium text-gray-500 uppercase block;
            }

            .value {
                @apply text-sm text-gray-900 font-semibold mt-1;
            }
        }
    }

    .detail-section {
        @apply border-t pt-3;

        .detail-line {
            @apply text-sm mb-1;

            .label {
                @apply font-medium text-gray-500;
            }

            .value {
                @apply text-gray-900 ml-2;
            }

            .link {
                @apply text-blue-600 hover:underline ml-2;
            }
        }
    }

    .source-section {
        @apply border-t pt-3;

        .source-line {
            @apply text-sm mb-1;

            .label {
                @apply font-medium text-gray-500;
            }

            .value {
                @apply text-gray-900 ml-2;
            }

            .link {
                @apply text-blue-600 hover:underline ml-2;
            }
        }
    }

    .comments-section {
        @apply border-t pt-3;

        label {
            @apply text-sm font-medium text-gray-500 block mb-2;
        }

        .comments-text {
            @apply text-sm text-gray-700 bg-gray-50 p-3 rounded whitespace-pre-wrap;
        }
    }
}
